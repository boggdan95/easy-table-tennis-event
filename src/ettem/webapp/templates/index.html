{% extends "base.html" %}

{% block title %}{{ t('nav.home') }} - {{ t('app.short_title') }}{% endblock %}

{% block page_title %}{{ t('dashboard.title') }}{% endblock %}

{% block content %}
<!-- Current Tournament Banner -->
{% if current_tournament %}
<div class="card mb-3" style="border: 2px solid var(--primary-color); background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), transparent);">
    <div class="card-body" style="padding: 1rem 1.5rem;">
        <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
            <div>
                <div style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.25rem;">{{ t('dashboard.active_tournament') }}</div>
                <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary-color);">
                    {{ current_tournament.name }}
                </div>
                {% if current_tournament.date or current_tournament.location %}
                <div style="font-size: 0.9rem; color: var(--text-muted);">
                    {{ current_tournament.date.strftime('%d/%m/%Y') if current_tournament.date else '' }}
                    {% if current_tournament.location %} - {{ current_tournament.location }}{% endif %}
                </div>
                {% endif %}
            </div>
            <a href="/tournaments" class="btn btn-secondary btn-sm">
                <span>{{ t('dashboard.manage_tournaments') }}</span>
            </a>
        </div>
    </div>
</div>
{% else %}
<div class="alert alert-info mb-3">
    <span class="icon">‚ÑπÔ∏è</span>
    <div class="alert-content" style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem; width: 100%;">
        <div>
            <div class="alert-title">{{ t('dashboard.welcome') }}</div>
            <div>{{ t('dashboard.welcome_message') }}</div>
        </div>
        <a href="/tournaments" class="btn btn-primary">
            <span>+</span>
            <span>{{ t('dashboard.create_tournament') }}</span>
        </a>
    </div>
</div>
{% endif %}

{% if categories %}
    <!-- Stats Overview -->
    <div class="grid grid-3 mb-3">
        <div class="stat-card">
            <div class="stat-value">{{ categories|length }}</div>
            <div class="stat-label">{{ t('dashboard.active_categories') }}</div>
        </div>
        <div class="stat-card secondary">
            <div class="stat-value">0</div>
            <div class="stat-label">{{ t('dashboard.pending_matches') }}</div>
        </div>
        <div class="stat-card success">
            <div class="stat-value">0</div>
            <div class="stat-label">{{ t('dashboard.completed_matches') }}</div>
        </div>
    </div>

    <!-- Categories List -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">{{ t('dashboard.available_categories') }}</h3>
        </div>
        <div class="card-body">
            <div class="grid grid-2">
                {% for category in categories %}
                <a href="/category/{{ category }}" class="card" style="text-decoration: none; transition: all 0.2s;">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div style="font-size: 2rem;">üèÜ</div>
                            <div>
                                <h4 style="margin: 0; color: var(--text-primary); font-size: 1.25rem;">{{ category }}</h4>
                                <p style="margin: 0.25rem 0 0; color: var(--text-muted); font-size: 0.875rem;">
                                    {{ t('dashboard.click_for_details') }}
                                </p>
                            </div>
                        </div>
                        <div style="font-size: 1.5rem; color: var(--primary-color);">‚Üí</div>
                    </div>
                </a>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">{{ t('dashboard.tournament_management') }}</h3>
        </div>
        <div class="card-body">
            <div class="grid grid-2 mb-3">
                <a href="/admin/import-players" class="btn btn-primary" style="justify-content: flex-start;">
                    <span>üì•</span>
                    <span>{{ t('nav.import_players') }}</span>
                </a>
                <a href="/admin/create-groups" class="btn btn-secondary" style="justify-content: flex-start;">
                    <span>üë•</span>
                    <span>{{ t('nav.create_groups') }}</span>
                </a>
                <a href="/admin/calculate-standings" class="btn btn-success" style="justify-content: flex-start;">
                    <span>üìä</span>
                    <span>{{ t('dashboard.calculate_standings') }}</span>
                </a>
                <a href="/admin/generate-bracket" class="btn btn-warning" style="justify-content: flex-start;">
                    <span>üèÖ</span>
                    <span>{{ t('dashboard.generate_bracket') }}</span>
                </a>
                <a href="/admin/direct-bracket" class="btn btn-warning" style="justify-content: flex-start;">
                    <span>üéØ</span>
                    <span>KO Directo (Sin Grupos)</span>
                </a>
            </div>
            <div class="alert alert-info" style="margin: 0;">
                <span class="icon">‚ÑπÔ∏è</span>
                <div class="alert-content">
                    <div class="alert-title">{{ t('dashboard.full_ui_management') }}</div>
                    <div>{{ t('dashboard.full_ui_management_msg') }}</div>
                </div>
            </div>
        </div>
    </div>
{% else %}
    <div class="alert alert-warning">
        <span class="icon">‚ö†Ô∏è</span>
        <div class="alert-content">
            <div class="alert-title">{{ t('dashboard.no_categories') }}</div>
            <div>{{ t('dashboard.no_categories_msg') }}</div>
        </div>
    </div>

    <!-- Getting Started Guide -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">üöÄ {{ t('dashboard.quick_start') }}</h3>
        </div>
        <div class="card-body">
            <p style="margin-bottom: 1.5rem;">{{ t('dashboard.follow_steps') }}</p>
            <div class="grid grid-1" style="gap: 1rem;">
                <div class="alert alert-info" style="margin: 0;">
                    <span class="icon" style="font-size: 2rem;">1Ô∏è‚É£</span>
                    <div class="alert-content">
                        <div class="alert-title">{{ t('dashboard.step1_title') }}</div>
                        <div style="margin-bottom: 1rem;">{{ t('dashboard.step1_desc') }}</div>
                        <a href="/admin/import-players" class="btn btn-primary">
                            <span>üì•</span>
                            <span>{{ t('dashboard.step1_action') }}</span>
                        </a>
                    </div>
                </div>

                <div class="alert alert-secondary" style="margin: 0; opacity: 0.7;">
                    <span class="icon" style="font-size: 2rem;">2Ô∏è‚É£</span>
                    <div class="alert-content">
                        <div class="alert-title">{{ t('dashboard.step2_title') }}</div>
                        <div>{{ t('dashboard.step2_desc') }}</div>
                    </div>
                </div>

                <div class="alert alert-secondary" style="margin: 0; opacity: 0.7;">
                    <span class="icon" style="font-size: 2rem;">3Ô∏è‚É£</span>
                    <div class="alert-content">
                        <div class="alert-title">{{ t('dashboard.step3_title') }}</div>
                        <div>{{ t('dashboard.step3_desc') }}</div>
                    </div>
                </div>

                <div class="alert alert-secondary" style="margin: 0; opacity: 0.7;">
                    <span class="icon" style="font-size: 2rem;">4Ô∏è‚É£</span>
                    <div class="alert-content">
                        <div class="alert-title">{{ t('dashboard.step4_title') }}</div>
                        <div>{{ t('dashboard.step4_desc') }}</div>
                    </div>
                </div>

                <div class="alert alert-secondary" style="margin: 0; opacity: 0.7;">
                    <span class="icon" style="font-size: 2rem;">5Ô∏è‚É£</span>
                    <div class="alert-content">
                        <div class="alert-title">{{ t('dashboard.step5_title') }}</div>
                        <div>{{ t('dashboard.step5_desc') }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endif %}

<!-- System Info -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">‚ÑπÔ∏è {{ t('dashboard.system_info') }}</h3>
    </div>
    <div class="card-body">
        <div class="grid grid-2">
            <div>
                <strong>{{ t('dashboard.version_label') }}:</strong> 1.2.0
            </div>
            <div>
                <strong>{{ t('dashboard.language_label') }}:</strong> {{ t('lang.' + lang) }}
            </div>
            <div>
                <strong>{{ t('dashboard.database_label') }}:</strong> SQLite (.ettem/ettem.sqlite)
            </div>
            <div>
                <strong>{{ t('dashboard.status_label') }}:</strong> <span class="badge badge-success">{{ t('dashboard.status_operational') }}</span>
            </div>
        </div>
    </div>
</div>
{% endblock %}
