{% extends "base.html" %}

{% block title %}Inicio - ETTEM{% endblock %}

{% block page_title %}Dashboard{% endblock %}

{% block content %}
<!-- Current Tournament Banner -->
{% if current_tournament %}
<div class="card mb-3" style="border: 2px solid var(--primary-color); background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), transparent);">
    <div class="card-body" style="padding: 1rem 1.5rem;">
        <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
            <div>
                <div style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.25rem;">Torneo Activo</div>
                <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary-color);">
                    {{ current_tournament.name }}
                </div>
                {% if current_tournament.date or current_tournament.location %}
                <div style="font-size: 0.9rem; color: var(--text-muted);">
                    {{ current_tournament.date.strftime('%d/%m/%Y') if current_tournament.date else '' }}
                    {% if current_tournament.location %} - {{ current_tournament.location }}{% endif %}
                </div>
                {% endif %}
            </div>
            <a href="/tournaments" class="btn btn-secondary btn-sm">
                <span>Gestionar Torneos</span>
            </a>
        </div>
    </div>
</div>
{% else %}
<div class="alert alert-info mb-3">
    <span class="icon">‚ÑπÔ∏è</span>
    <div class="alert-content" style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem; width: 100%;">
        <div>
            <div class="alert-title">Bienvenido a ETTEM</div>
            <div>Gestiona torneos de tenis de mesa con grupos round robin y llaves eliminatorias.</div>
        </div>
        <a href="/tournaments" class="btn btn-primary">
            <span>+</span>
            <span>Crear Torneo</span>
        </a>
    </div>
</div>
{% endif %}

{% if categories %}
    <!-- Stats Overview -->
    <div class="grid grid-3 mb-3">
        <div class="stat-card">
            <div class="stat-value">{{ categories|length }}</div>
            <div class="stat-label">Categor√≠as Activas</div>
        </div>
        <div class="stat-card secondary">
            <div class="stat-value">0</div>
            <div class="stat-label">Partidos Pendientes</div>
        </div>
        <div class="stat-card success">
            <div class="stat-value">0</div>
            <div class="stat-label">Partidos Completados</div>
        </div>
    </div>

    <!-- Categories List -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Categor√≠as Disponibles</h3>
        </div>
        <div class="card-body">
            <div class="grid grid-2">
                {% for category in categories %}
                <a href="/category/{{ category }}" class="card" style="text-decoration: none; transition: all 0.2s;">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div style="font-size: 2rem;">üèÜ</div>
                            <div>
                                <h4 style="margin: 0; color: var(--text-primary); font-size: 1.25rem;">{{ category }}</h4>
                                <p style="margin: 0.25rem 0 0; color: var(--text-muted); font-size: 0.875rem;">
                                    Clic para ver detalles
                                </p>
                            </div>
                        </div>
                        <div style="font-size: 1.5rem; color: var(--primary-color);">‚Üí</div>
                    </div>
                </a>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Gesti√≥n de Torneo</h3>
        </div>
        <div class="card-body">
            <div class="grid grid-2 mb-3">
                <a href="/admin/import-players" class="btn btn-primary" style="justify-content: flex-start;">
                    <span>üì•</span>
                    <span>Importar Jugadores</span>
                </a>
                <a href="/admin/create-groups" class="btn btn-secondary" style="justify-content: flex-start;">
                    <span>üë•</span>
                    <span>Crear Grupos</span>
                </a>
                <a href="/admin/calculate-standings" class="btn btn-success" style="justify-content: flex-start;">
                    <span>üìä</span>
                    <span>Calcular Standings</span>
                </a>
                <a href="/admin/generate-bracket" class="btn btn-warning" style="justify-content: flex-start;">
                    <span>üèÖ</span>
                    <span>Generar Bracket</span>
                </a>
            </div>
            <div class="alert alert-info" style="margin: 0;">
                <span class="icon">‚ÑπÔ∏è</span>
                <div class="alert-content">
                    <div class="alert-title">Gesti√≥n Completa desde la UI</div>
                    <div>Todas las operaciones del torneo ahora disponibles directamente desde la interfaz web.</div>
                </div>
            </div>
        </div>
    </div>
{% else %}
    <div class="alert alert-warning">
        <span class="icon">‚ö†Ô∏è</span>
        <div class="alert-content">
            <div class="alert-title">Sin Categor√≠as</div>
            <div>No hay jugadores ni categor√≠as registradas. Comienza importando jugadores para crear tu primer torneo.</div>
        </div>
    </div>

    <!-- Getting Started Guide -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">üöÄ Gu√≠a de Inicio R√°pido</h3>
        </div>
        <div class="card-body">
            <p style="margin-bottom: 1.5rem;">Sigue estos pasos para configurar tu torneo:</p>
            <div class="grid grid-1" style="gap: 1rem;">
                <div class="alert alert-info" style="margin: 0;">
                    <span class="icon" style="font-size: 2rem;">1Ô∏è‚É£</span>
                    <div class="alert-content">
                        <div class="alert-title">Importar Jugadores</div>
                        <div style="margin-bottom: 1rem;">Carga los jugadores desde un archivo CSV o agr√©galos manualmente.</div>
                        <a href="/admin/import-players" class="btn btn-primary">
                            <span>üì•</span>
                            <span>Ir a Importar Jugadores</span>
                        </a>
                    </div>
                </div>

                <div class="alert alert-secondary" style="margin: 0; opacity: 0.7;">
                    <span class="icon" style="font-size: 2rem;">2Ô∏è‚É£</span>
                    <div class="alert-content">
                        <div class="alert-title">Crear Grupos</div>
                        <div>Organiza los jugadores en grupos de round robin (disponible despu√©s de importar).</div>
                    </div>
                </div>

                <div class="alert alert-secondary" style="margin: 0; opacity: 0.7;">
                    <span class="icon" style="font-size: 2rem;">3Ô∏è‚É£</span>
                    <div class="alert-content">
                        <div class="alert-title">Registrar Resultados</div>
                        <div>Ingresa los resultados de los partidos desde la interfaz web.</div>
                    </div>
                </div>

                <div class="alert alert-secondary" style="margin: 0; opacity: 0.7;">
                    <span class="icon" style="font-size: 2rem;">4Ô∏è‚É£</span>
                    <div class="alert-content">
                        <div class="alert-title">Generar Bracket</div>
                        <div>Crea la llave eliminatoria con los clasificados de cada grupo.</div>
                    </div>
                </div>

                <div class="alert alert-secondary" style="margin: 0; opacity: 0.7;">
                    <span class="icon" style="font-size: 2rem;">5Ô∏è‚É£</span>
                    <div class="alert-content">
                        <div class="alert-title">Ver Resultados Finales</div>
                        <div>Consulta el podio y los resultados finales del torneo.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endif %}

<!-- System Info -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">‚ÑπÔ∏è Informaci√≥n del Sistema</h3>
    </div>
    <div class="card-body">
        <div class="grid grid-2">
            <div>
                <strong>Versi√≥n:</strong> 1.1.0
            </div>
            <div>
                <strong>Idioma:</strong> {{ 'Espa√±ol' if lang == 'es' else 'English' }}
            </div>
            <div>
                <strong>Base de Datos:</strong> SQLite (.ettem/ettem.sqlite)
            </div>
            <div>
                <strong>Estado:</strong> <span class="badge badge-success">Operativo</span>
            </div>
        </div>
    </div>
</div>
{% endblock %}
